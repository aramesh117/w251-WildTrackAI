
<!DOCTYPE html>
<html>
<head>
	
	<title>Wild Track AI</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>

	<style>
		body {
            padding: 0;
            margin: 0;
        }
        html, body, #map {
            height: 100%;
            width: 100%;
        }
	</style>

</head>
<body>

<!-- Added for search -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>
<script src="https://rawgit.com/calvinmetcalf/leaflet-ajax/master/dist/leaflet.ajax.min.js"></script>
<!-- End Added for search -->

<script src="trackfile.js"></script>
<script src='controllers/search.js'></script>
<div id='map'></div>
<script>
	
	// Initialize Leaflet map at coordinates with zoom level
	var map = L.map('map').setView([-14.627472,26.165583], 13);

	// Add openstreetmap tiles
	L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
		attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
	}).addTo(map);

	// Extend leaflet icon object to generalize icon size as well as icon and popup anchors
	var TrackIcon = L.Icon.extend({
		options: {
			iconSize:     [77, 80],
			iconAnchor:   [22, 94],
			popupAnchor:  [-3, -76]
		}
	});
	
    // Collect properties into a string to populate popupContent
	function onEachFeature(feature, layer) {
		var popupContent = ""

		if (feature.properties && feature.properties.species) {
			popupContent += "Species: " + feature.properties.species + "<br>";
		} else {
			popupContent += "Species: Unknown" + "<br>";
		}

		if (feature.properties && feature.properties.species) {
			popupContent += "Name: " + feature.properties.name + "<br>";
		} else {
			popupContent += "Name: Unknown" + "<br>";
		}

		if (feature.properties && feature.properties.sex) {
			if (feature.properties.sex == "U") {
				popupContent += "Sex: Unknown" + "<br>";
			} else if (feature.properties.sex == "F") {
				popupContent += "Sex: Female" + "<br>";
			} else {
				popupContent += "Sex: Male" + "<br>";
			}
		} else {
			popupContent += "Name: Unknown" + "<br>";
		}

		if (feature.geometry && feature.geometry.coordinates) {
			popupContent += "Latitude : " + feature.geometry.coordinates[1] + "<br>";
			popupContent += "Longitude: " + feature.geometry.coordinates[0] + "<br>";
		}

		layer.bindPopup(popupContent);
	}
	
    // Add icon markers to map
	var tracksLayer = L.geoJSON(wildtracks, {
		pointToLayer: function (feature, latlng) {
		return L.marker(latlng, {icon: new TrackIcon({iconUrl: feature.properties.iconUrl }) });
	},
		onEachFeature: onEachFeature
	}).addTo(map);
	
	//var legend2 = L.control({position: 'bottomright'}); 
	//legend2.onAdd = function (map) {        
    //	var div = L.DomUtil.create('div', 'info legend2');
    //	div.innerHTML = '<img src="images/wildtrack-logo.png" >';     
    //	return div;
	//};      
	//legend2.addTo(map);

	L.Control.Watermark = L.Control.extend({
    onAdd: function(map) {
        var img = L.DomUtil.create('img');

        img.src = 'images/wildtrack-logo-removebg-preview.png';
        img.style.width = '200px';

        return img;
    },

    onRemove: function(map) {
        // Nothing to do here
    }
	});

	L.control.watermark = function(opts) {
    	return new L.Control.Watermark(opts);
	}

	L.control.watermark({ position: 'bottomright' }).addTo(map);

	L.control.search({
		data: wildtracks
	}).addTo(map);
</script>



</body>
</html>
